#!/usr/bin/env ruby
# executes a command on vagrant VM using VBoxManage guestcontrol

book = File.basename(Dir.pwd)
block_status = `knife block`
selected = block_status.lines.find {|l| l =~ /Currently Selected/}
server = selected.match(/\b(.+)\s\[/)[1]

puts "Uploading: " + book + " to " + server

puts system("knife cookbook upload #{book} -o ..")
